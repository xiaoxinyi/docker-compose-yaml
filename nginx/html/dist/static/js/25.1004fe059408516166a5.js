webpackJsonp([25],{1329:function(e,t,s){var i=s(1330);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s(590)("e0644408",i,!0,{})},1330:function(e,t,s){(e.exports=s(589)()).push([e.i,".activeMenu,.sales-clerk-manage-menu:hover{background-color:rgba(188,197,202,.17)}.edit-store-modal .clerk-departing-modal-info{height:60px;line-height:60px;text-align:center}.sales-clerk-manage-menu{height:50px;line-height:50px;text-align:center;font-size:14px;color:#7D7D7D;position:relative;cursor:pointer}.sales-clerk-manage-menu .dropdownIcon{display:none}.sales-clerk-manage-menu:hover .dropdownIcon{display:inline-block}.sales-clerk-manage-menu .ivu-dropdown{position:absolute;right:20px;height:30px}.sales-clerk-manage-menu .ivu-dropdown-rel{height:30px}.sales-clerk-manage-info-content .input-search-content{float:right;height:32px;width:200px;display:inline-block;position:relative}.sales-clerk-manage-info-content .input-search-content .input-search-icon{position:absolute;right:6px;top:6px;z-index:9;color:#C2C1C1;cursor:pointer}.salesclerk-list .salesclerk-table{text-align:center;border-top:1px solid #DDD;border-left:1px solid #DDD;cursor:pointer;height:40px;padding:0 10px;overflow:hidden}.salesclerk-list .salesclerk-table .ivu-poptip-popper{max-width:276px}.salesclerk-list .salesclerk-table span{display:inline-block;line-height:40px;height:40px}.salesclerk-table .ivu-poptip,.salesclerk-table .ivu-poptip .ivu-poptip-rel{width:100%;height:40px}.salesclerk-list .salesclerk-table.visit-store{line-height:40px}.salesclerk-list .salesclerk-table.visit-store .ivu-btn{padding:4px}.salesclerk-list .salesclerk-table:last-child{border-right:1px solid #DDD}.salesclerk-list-title,.salesclerk-list:hover{background-color:#F8F8F9}.storeListContent span{display:inline-block;padding:0 6px;height:30px;line-height:30px;text-align:center;font-size:12px;float:left}.storeListContent .edit{height:30px;line-height:30px;text-align:right;padding-right:20px;color:#0098CC;cursor:pointer}label.ivu-checkbox-wrapper-disabled{pointer-events:none!important}",""])},1331:function(e,l,d){"use strict";Object.defineProperty(l,"__esModule",{value:!0}),function(n){var e=d(305),A=d.n(e),t=d(306),o=d.n(t),s=d(769),i=d.n(s),y=d(307),r=d(803),a=d(834);l.default={mixins:[r.a,a.a],data:function(){return{storeAreaList:[],ifActionDepartment:!1,ifActionEmployee:!1,managementJson:{},page:1,firstAreaList:[],departingEmployeesCount:0,departingEmployees:[],activeDepartmentId:0,ifselected:!0,storesSelected:[],deleteEmployeeId:"",employeesCount:0,allPositions:[],allDepartments:[],departingClerkName:"",clerkDepartingModal:!1,storeValue:"",saveEditStore:!1,employeeNameSearched:"",storeAddressTree:[],employees:[],allInitPermissions:[],allInitStores:[],allOriginalStoresData:[],allStoresIdListSelected:[],allStoresFromAreaSelected:[],openAddStoresModal:!1,openAddStorePermissionsModal:!1,storesOfPermissionsAdded:[],employeeEdited:{department_id:"",position_id:"",username:"",sex:"1",password:"",rePassword:"",phone:"",stores:[],address:"",identity:"",email:"",employed_time:new Date,director:"",store_permissions:[],position_permissions:[],storesOfPermissionsAdded:[],storesManaged:[],avatar:""},storeIdSelected:[],activeDepartment:{}}},mounted:function(){this.managementJson=JSON.parse(window.sessionStorage.getItem("managementJson")),this.checkManagement(),this.getStoreAddressTree(),this.getAllInitPermissions(),this.getAllDepartments(),this.getAllPositions(),this.getAllEmployees(),this.getAllDepartingEmployees()},computed:{allStoresSelected:function(){var e=this,s=[];return this.allStoresIdListSelected.forEach(function(t){e.allOriginalStoresData.forEach(function(e){t===e.store_id&&s.push(e)})}),s}},methods:{editStoresManagedFromEmployeeSelected:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.openAddStoresModal=!0;var s=n.cloneDeep(e);this.allStoresIdListSelected=i()(s.permissions.stores),this.allStoresIdListSelected=n.map(this.allStoresIdListSelected,function(e){return Number(e)}),s.storesManaged=s.stores;var t=this.allPositions.find(function(e){return e.id===s.position_id});n.each(s.storesManaged,function(e){e.store_permissions=t.store_permissions}),s.store_permissions=s.storesManaged[0].store_permissions,i()(s.permissions.stores).forEach(function(t){s.storesManaged.forEach(function(e){Number(t)===e.store_id&&(e.permissionsSelected=s.permissions.stores[t])})}),s.storesOfPermissionsAdded=[],this.employeeEdited=s,this.selectArea(this.firstAreaList)},selectArea:function(e){this.ifselected=!1,this.getAllStoresFromAreaSelected(e),this.updateStoresSelectedCheckboxState(),this.ifselected=!0},checkManagement:function(){for(var e in this.managementJson)"21"===e&&(this.ifActionDepartment=this.managementJson[e]),"23"===e&&(this.ifActionEmployee=this.managementJson[e])},selectAllEmployees:function(){this.activeDepartmentId=0,this.getAllEmployees(),this.allDepartments.forEach(function(e){e.isActive=!1})},paging:function(e){this.page=e,this.getAllEmployees()},getAllEmployees:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,0!==s.activeDepartmentId){e.next=7;break}return e.next=4,y.R(s.page);case 4:t=e.sent,e.next=10;break;case 7:return e.next=9,y.R(s.page,s.activeDepartmentId);case 9:t=e.sent;case 10:t&&200===t.code&&(s.employeesCount=t.data.total,s.employees=t.data.employees,s.employees.forEach(function(e){var t=[];e.stores.forEach(function(e){t.push(e.store_name)}),e.storesInManagement=t.toString(),"1"===e.sex||null===e.sex?e.gender="男":e.gender="女"}));case 11:case"end":return e.stop()}},e,s)}))()},getAllDepartingEmployees:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.P(1,0);case 2:(t=e.sent)&&200===t.code&&(s.departingEmployeesCount=t.data.total,s.departingEmployees=t.data.employees);case 4:case"end":return e.stop()}},e,s)}))()},getStoreArea:function(e){for(var t in e)e[t].children?this.getStoreArea(e[t].children):this.storeAreaList=this.storeAreaList.concat(e)},getAllDepartments:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.allDepartments=[],e.next=3,y.Q();case 3:(t=e.sent)&&200===t.code&&t.data.forEach(function(e){var t={id:e.id,name:e.name,isActive:!1,permissions:e.permissions,totalPermissions:e.total_permissions};s.allDepartments.push(t)});case 5:case"end":return e.stop()}},e,s)}))()},getAllPositions:function(){var i=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.allPositions=[],e.next=3,y.T(0);case 3:(t=e.sent)&&200===t.code&&t.data.forEach(function(e){var s={};n.forOwn(e.permissions,function(e,t){"string"==typeof e&&(e=""===e?[]:n.map(e.split(","),Number)),s[t]=e}),e.permissions=s;var t={id:e.id,name:e.name,permissions:e.position_permissions,description:e.description,departmentName:e.department_name,departmentAttached:{id:e.department_id,name:e.department_name,permissions:e.department_permissions},management_permissions:e.permissions.management,store_permissions:e.permissions.stores};i.allPositions.push(t)});case 5:case"end":return e.stop()}},e,i)}))()},getStoreAddressTree:function(){var _=this;return o()(A.a.mark(function e(){var t,s,i,n,o,r,a,l,d,c,p,m,u,h,f,g,v,S,k;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s=!(t=[]),e.next=5,y._23();case 5:if((n=e.sent)&&200===n.code)for(o in t=n.data){for(d in r={title:o,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(r),a=[],l=t[o]){for(u in c={title:d,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(c),p=[],m=l[d]){for(g in h={},f=m[u],s?h={title:u,selected:!1}:(h={title:u,selected:!0},s=!0),f)_.allOriginalStoresData=_.allOriginalStoresData.concat(f[g]),f[g].selected=!1;p.push(h),i||(_.firstAreaList.push(h),i=!0),v={title:u,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(v),r.stores=r.stores.concat(t[o][d][u]),c.stores=c.stores.concat(t[o][d][u]),v.stores=t[o][d][u]}S={title:d,expand:!0,children:p},a.push(S)}k={title:o,expand:!0,children:a},_.storeAddressTree.push(k)}case 7:case"end":return e.stop()}},e,_)}))()},searchEmployee:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y._48(s.employeeNameSearched);case 2:(t=e.sent)&&200===t.code?(s.employees=t.data,n.each(s.employees,function(e){var t=[];e.stores.length?n.each(e.stores,function(e){t.push(e.store_name)}):t=["暂未添加店铺"],e.storesInManagement=t.toString(),"1"===e.sex?e.gender="女":e.gender="男"})):s.$Message.error("没有该员工！");case 4:case"end":return e.stop()}},e,s)}))()},selectDepartment:function(e){this.allDepartments.forEach(function(e){e.isActive=!1}),e.isActive=!0,this.activeDepartmentId=e.id,this.getAllEmployees(),this.activeDepartment=e},clickDropdown:function(t,s){var i=this;return o()(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"edit"===t?i.editDepartment(s):"delete"===t&&i.deleteDepartment(s);case 1:case"end":return e.stop()}},e,i)}))()},editDepartment:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"creatDepartment",params:{type:"editDepartment",allInitPermissions:this.allInitPermissions,departmentEdited:{id:e.id,name:e.name,totalPermissions:e.totalPermissions}}})},deleteDepartment:function(s){var i=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.T(s.id);case 2:if(!(t=e.sent)||!t.data||0!==t.data.length){e.next=10;break}return e.next=6,y.y(s.id);case 6:e.sent&&(i.$Message.success("删除部门成功"),i.getAllDepartments(),i.selectAllEmployees()),e.next=12;break;case 10:i.$Message.error({content:"该部门下有岗位存在，不能删除该部门",duration:3}),i.selectAllEmployees();case 12:case"end":return e.stop()}},e,i)}))()},addEmployee:function(){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"editEmployee",params:{type:"creatEmployee",allDepartments:this.allDepartments,allPositions:this.allPositions,allInitPermissions:this.allInitPermissions,storeAddressTree:this.storeAddressTree,firstAreaList:this.firstAreaList,allInitStores:this.allInitStores,allOriginalStoresData:this.allOriginalStoresData,activeDepartment:this.activeDepartment,activeDepartmentId:this.activeDepartmentId}})},editEmployee:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"editEmployee",params:{type:"editEmployee",employee:e,storesSelected:this.storesSelected,allDepartments:this.allDepartments,allPositions:this.allPositions,allInitPermissions:this.allInitPermissions,storeAddressTree:this.storeAddressTree,firstAreaList:this.firstAreaList,allInitStores:this.allInitStores,allOriginalStoresData:this.allOriginalStoresData}})},resignEmployee:function(e){this.departingClerkName=e.username,this.deleteEmployeeId=e.id,this.clerkDepartingModal=!0},deleteStoreSelected:function(s){var i=this;this.allStoresIdListSelected.forEach(function(e,t){e===s&&i.allStoresIdListSelected.splice(t,1)}),this.updateStoresSelectedCheckboxState()},toDepartingClerk:function(){this.$router.push({name:"departingEmployees",params:{departing:this.departingEmployees}})},creatDepartment:function(){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"creatDepartment",params:{type:"creatDepartment",allInitPermissions:this.allInitPermissions}})},getAllInitPermissions:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.S();case 2:(t=e.sent)&&200===t.code&&(s.allInitPermissions=t.data);case 4:case"end":return e.stop()}},e,s)}))()},getCheckboxAbledCounts:function(){this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){e.disabled||(t.checkboxAbledCount+=1)})})},clerkDeparting:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y._44(s.deleteEmployeeId);case 2:(t=e.sent)&&200===t.code&&(s.clerkDepartingModal=!1,s.$Message.success("离职成功"),s.getAllEmployees(),s.getAllDepartingEmployees());case 4:case"end":return e.stop()}},e,s)}))()},cancelClerkDeparting:function(){this.clerkDepartingModal=!1},handleCheckAllStore:function(t){var s=this;this.ifselected=!1,t.checkAll=!t.checkAll,t.indeterminate=!1,t.checkAll?(t.storeGroupIds=[],t.stores.forEach(function(e){e.selected=!0,t.storeGroupIds.push(e.store_id),s.allStoresIdListSelected.includes(e.store_id)||s.allStoresIdListSelected.push(e.store_id)})):(t.storeGroupIds=[],t.stores.forEach(function(e){e.selected=!1;var t=s.allStoresIdListSelected.indexOf(e.store_id);-1!==t&&s.allStoresIdListSelected.splice(t,1)})),this.ifselected=!0,this.renderStoreCheckboxState(t)},renderStoreCheckboxState:function(e){e.storeGroupIds.length===e.stores.length?(e.checkAll=!0,e.indeterminate=!1):0<e.storeGroupIds.length&&e.storeGroupIds.length<e.stores.length?(e.checkAll=!1,e.indeterminate=!0):(e.checkAll=!1,e.indeterminate=!1)},handleCheckSingleStore:function(e,t){this.ifselected=!1;var s=e.storeGroupIds.indexOf(t.store_id);if(-1!==s){t.selected=!1,e.storeGroupIds.splice(s,1);var i=this.allStoresIdListSelected.indexOf(t.store_id);-1!==i&&this.allStoresIdListSelected.splice(i,1)}else t.selected=!0,e.storeGroupIds.push(t.store_id),this.allStoresIdListSelected.includes(t.store_id)||this.allStoresIdListSelected.push(t.store_id);e.storeGroupIds.length===e.stores.length?(e.checkAll=!0,e.indeterminate=!1):0<e.storeGroupIds.length&&e.storeGroupIds.length<e.stores.length?(e.checkAll=!1,e.indeterminate=!0):e.indeterminate=!1,this.renderStoreCheckboxState(e),this.ifselected=!0},submit:function(){var t,r=this;this.$refs.employeeEdited.validate((t=o()(A.a.mark(function e(t){var s,i,n,o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=17;break}if(s=[],r.employeeEdited.storesManaged.length?r.employeeEdited.storesManaged.forEach(function(e){s.push({id:e.store_id,name:e.store_name,permissions:e.permissionsSelected})}):r.$Message.error({content:"未添加店铺",duration:3}),i=void 0,i=r.employeeEdited.employed_time?parseInt(Number(r.employeeEdited.employed_time.getTime())/1e3):parseInt((new Date).getTime()/1e3),"添加员工"!==r.employeeOperationType){e.next=10;break}return e.next=8,y.m(r.employeeEdited.position_id,r.employeeEdited.department_id,r.employeeEdited.username,r.employeeEdited.password,r.employeeEdited.sex,r.employeeEdited.phone,s,r.employeeEdited.avatar,r.employeeEdited.address,r.employeeEdited.identity,r.employeeEdited.email,i,r.employeeEdited.director);case 8:(n=e.sent)&&200===n.code&&(r.$router.push("/salesclerkManage/clerkManage/department"),r.$Message.success("添加员工成功!"));case 10:if("编辑员工"!==r.employeeOperationType){e.next=15;break}return e.next=13,y._54(r.employeeEdited.id,r.employeeEdited.position_id,r.employeeEdited.department_id,r.employeeEdited.username,r.employeeEdited.password,r.employeeEdited.sex,r.employeeEdited.phone,s,r.employeeEdited.avatar,r.employeeEdited.address,r.employeeEdited.identity,r.employeeEdited.email,i,r.employeeEdited.director);case 13:(o=e.sent)&&200===o.code&&(r.$router.push("/salesclerkManage/clerkManage/department"),r.$Message.success("编辑员工成功!"));case 15:e.next=18;break;case 17:r.$Message.error("表单验证失败!");case 18:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},cancelEditStore:function(){this.storesAddedIsSaved||(this.allStoresFromAreaSelected={},this.allStoresIdListSelected=[]),this.openAddStoresModal=!1},handleCheckAll:function(e){var i=this;this.ifselected=!1,e.checkAll=!e.checkAll,e.indeterminate=!1,e.disabled||(e.checkAll?(e.permissionIds=[],e.functions.forEach(function(t){t.disabled||(t.selected=!0,e.permissionIds.push(t.id),i.employeeEdited.storesOfPermissionsAdded.forEach(function(e){e.store_id===i.storeIdSelected&&(e.permissionsSelected.includes(t.id)||e.permissionsSelected.push(t.id))}))})):(e.permissionIds=[],e.functions.forEach(function(s){s.disabled||(s.selected=!1,i.employeeEdited.storesOfPermissionsAdded.forEach(function(e){if(e.store_id===i.storeIdSelected){var t=e.permissionsSelected.indexOf(s.id);-1!==t&&e.permissionsSelected.splice(t,1)}}))}))),this.renderCheckboxState(),this.updatePermissionsSelectedFromStoreSelected(this.storeIdSelected),this.ifselected=!0},handleCheckSingle:function(e,s){var i=this;this.ifselected=!1;var t=e.permissionIds.indexOf(s.id);-1!==t?(s.selected=!1,e.permissionIds.splice(t,1),this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){if(e.store_id===i.storeIdSelected){var t=e.permissionsSelected.indexOf(s.id);-1!==t&&e.permissionsSelected.splice(t,1)}})):(s.selected=!0,e.permissionIds.push(s.id),this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){e.store_id===i.storeIdSelected&&e.permissionsSelected.push(s.id)})),e.permissionIds.length===e.checkboxAbledCount?e.checkAll=!0:e.checkAll=!1,0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?e.indeterminate=!0:e.indeterminate=!1,this.renderCheckboxState(),this.updatePermissionsSelectedFromStoreSelected(this.storeIdSelected),this.ifselected=!0},updatePermissionsSelectedFromStoreSelected:function(t){var s={};this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){t===e.store_id&&(s=e)}),this.allInitPermissions.forEach(function(e){e.checkAll?e.functions.forEach(function(e){s.permissionsSelected.includes(e.id)||s.permissionsSelected.push(e.id)}):e.functions.forEach(function(e){if(s.permissionsSelected.includes(e.id)){var t=s.permissionsSelected.indexOf(e.id);s.permissionsSelected.splice(t,1)}}),e.functions.forEach(function(e){if(e.selected&&!s.permissionsSelected.includes(e.id)&&s.permissionsSelected.push(e.id),!e.selected&&s.permissionsSelected.includes(e.id)){var t=s.permissionsSelected.indexOf(e.id);s.permissionsSelected.splice(t,1)}})})},cancelSaveEditStore:function(){this.storesAddedIsSaved||(this.allStoresFromAreaSelected={},this.allStoresIdListSelected=[],this.employeeEdited.storesManaged=[]),this.openAddStorePermissionsModal=!1},save:function(){var i=this;return o()(A.a.mark(function e(){var t,s;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.employeeEdited.storesManaged=n.cloneDeep(i.employeeEdited.storesOfPermissionsAdded),t=[],i.employeeEdited.storesManaged.length&&i.employeeEdited.storesManaged.forEach(function(e){t.push({id:e.store_id,name:e.store_name,permissions:e.permissionsSelected})}),i.employeeEdited.storesOfPermissionsAdded.length=0,i.storesAddedIsSaved=!0,i.openAddStorePermissionsModal=!1,e.next=8,y._56(t,i.employeeEdited.id);case 8:(s=e.sent)&&200===s.code?(i.saveEditStore=!1,i.$Message.success("保存成功"),i.getUserInfoByTokenAction(),i.getAllEmployees()):i.$Message.error(s.error_msg);case 10:case"end":return e.stop()}},e,i)}))()}}}}.call(l,d(123))},1332:function(e,t){e.exports={render:function(){var i=this,e=i.$createElement,n=i._self._c||e;return n("Row",[n("Col",{staticClass:"layout-menu-left",attrs:{span:"3"}},[n("p",{staticClass:"sales-clerk-manage-content-department PingFangSC-Medium-font"},[i._v("\n            部门\n            "),i.ifActionDepartment?n("Button",{attrs:{type:"ghost"},on:{click:i.creatDepartment}},[i._v("新建")]):i._e()],1),i._v(" "),n("p",{staticClass:"sales-clerk-manage-all",on:{click:i.selectAllEmployees}},[i._v("全部员工")]),i._v(" "),n("div",i._l(i.allDepartments,function(t,e){return n("p",{key:e,staticClass:"sales-clerk-manage-menu",class:{activeMenu:t.isActive},on:{click:function(e){i.selectDepartment(t)}}},[i._v(i._s(t.name)+"\n                "),i.ifActionDepartment?n("Dropdown",{staticClass:"dropdownIcon"},[n("Icon",{attrs:{type:"gear-b"}}),i._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{attrs:{name:"修改"},nativeOn:{click:function(e){e.preventDefault(),i.clickDropdown("edit",t)}}},[i._v("\n                            修改\n                        ")]),i._v(" "),n("DropdownItem",{attrs:{name:"删除"},nativeOn:{click:function(e){e.preventDefault(),i.clickDropdown("delete",t)}}},[i._v("删除\n                        ")])],1)],1):i._e()],1)}))]),i._v(" "),n("Col",{staticClass:"sales-clerk-manage-info",attrs:{span:"21"}},[n("div",{staticClass:"sales-clerk-manage-info-main"},[n("p",{staticClass:"sales-clerk-manage-info-title"},[n("span",{staticClass:"current-clerk"},[i._v("当前员工 ("+i._s(i.employeesCount)+")")]),n("span",{staticClass:"look-departing-employees",on:{click:i.toDepartingClerk}},[i._v("查看离职员工("+i._s(i.departingEmployeesCount)+")")])]),i._v(" "),n("div",{staticClass:"sales-clerk-manage-info-content"},[n("p",{staticClass:"search-content"},[i.ifActionEmployee?n("Button",{attrs:{type:"primary"},on:{click:i.addEmployee}},[i._v("添加员工")]):i._e(),i._v(" "),n("span",{staticClass:"input-search-content"},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入员工姓名"},on:{"on-enter":i.searchEmployee},model:{value:i.employeeNameSearched,callback:function(e){i.employeeNameSearched=e},expression:"employeeNameSearched"}}),i._v(" "),n("Icon",{staticClass:"input-search-icon",attrs:{type:"search",size:"18"},nativeOn:{click:function(e){return i.searchEmployee(e)}}})],1)],1),i._v(" "),n("Row",{staticClass:"salesclerk-list salesclerk-list-title"},[n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[n("span",[i._v("序号")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[n("span",[i._v("工号")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[n("span",[i._v("姓名")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:i.ifActionEmployee?3:5}},[n("span",[i._v("账号名")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[n("span",[i._v("性别")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[n("span",[i._v("部门")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[n("span",[i._v("岗位")])]),i._v(" "),n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[n("span",[i._v("店铺")])]),i._v(" "),i.ifActionEmployee?n("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[n("span",[i._v("操作")])]):i._e()],1),i._v(" "),i._l(i.employees,function(t,e){return n("Row",{key:e,staticClass:"salesclerk-list"},[n("Col",{staticClass:"salesclerk-table",attrs:{span:"2"}},[n("span",[i._v(i._s(e+1))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[n("span",[i._v(i._s(t.serial))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[n("span",[i._v(i._s(t.username))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:i.ifActionEmployee?3:5}},[n("span",[i._v(i._s(t.username))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"2"}},[n("span",[i._v(i._s(t.gender))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[n("span",[i._v(i._s(t.department_name))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[n("span",[i._v(i._s(t.position_name))])]),i._v(" "),n("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[n("Poptip",{attrs:{transfer:!0,trigger:"hover",placement:"bottom",width:"100px"}},[n("span",[i._v(i._s(t.storesInManagement))]),i._v(" "),n("div",{staticClass:"storeListContent",attrs:{slot:"content"},slot:"content"},[n("div",{staticStyle:{overflow:"hidden"}},i._l(t.stores,function(e){return n("span",[i._v(i._s(e.store_name))])})),i._v(" "),i.ifActionEmployee?n("p",{staticClass:"edit",on:{click:function(e){i.editStoresManagedFromEmployeeSelected(t)}}},[i._v("修改店铺")]):i._e()])])],1),i._v(" "),i.ifActionEmployee?n("Col",{staticClass:"salesclerk-table visit-store",attrs:{span:"2"}},[n("Button",{attrs:{type:"text",icon:"edit"},on:{click:function(e){i.editEmployee(t)}}}),i._v(" "),n("Button",{attrs:{type:"text",icon:"android-delete"},on:{click:function(e){i.resignEmployee(t)}}})],1):i._e()],1)}),i._v(" "),n("p",{staticClass:"page"},[n("Page",{attrs:{total:1,"show-total":"","show-elevator":""},on:{"on-change":i.paging}})],1)],2)])]),i._v(" "),n("Modal",{staticClass:"edit-store-modal",attrs:{title:"修改店铺",width:"800"},model:{value:i.openAddStoresModal,callback:function(e){i.openAddStoresModal=e},expression:"openAddStoresModal"}},[n("div",{staticClass:"edit-store-modal-content"},[n("div",{staticClass:"edit-store-modal-content-tree"},[n("p",{staticClass:"edit-store-modal-content-tree-title PingFangSC-Medium-font"},[i._v("区域")]),i._v(" "),n("Tree",{attrs:{data:i.storeAddressTree},on:{"on-select-change":i.selectArea}})],1),i._v(" "),n("div",{staticClass:"edit-store-modal-content-info"},[n("div",{staticClass:"edit-store-modal-content-info-store"},[n("Input",{attrs:{placeholder:"请输入..."},model:{value:i.storeValue,callback:function(e){i.storeValue=e},expression:"storeValue"}}),i._v(" "),n("Checkbox",{attrs:{value:i.allStoresFromAreaSelected.checkAll,indeterminate:i.allStoresFromAreaSelected.indeterminate},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckAllStore(i.allStoresFromAreaSelected)}}},[i._v("\n                        全选\n                    ")]),i._v(" "),i._l(i.allStoresFromAreaSelected.stores,function(t,e){return n("div",{directives:[{name:"show",rawName:"v-show",value:i.ifselected,expression:"ifselected"}],key:e},[n("CheckboxGroup",{staticStyle:{float:"left"},model:{value:i.allStoresFromAreaSelected.storeGroupIds,callback:function(e){i.$set(i.allStoresFromAreaSelected,"storeGroupIds",e)},expression:"allStoresFromAreaSelected.storeGroupIds"}},[n("Checkbox",{key:Math.random(),attrs:{value:t.selected,label:t.store_id},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckSingleStore(i.allStoresFromAreaSelected,t)}}},[i._v("\n                                "+i._s(t.sotre_name)+"\n                            ")])],1)],1)})],2),i._v(" "),n("div",{staticClass:"edit-store-modal-content-info-store-selected"},[n("p",{staticClass:"edit-store-modal-content-info-store-selected-title PingFangSC-Medium-font"},[i._v("已添加店铺")]),i._v(" "),n("div",{staticClass:"edit-store-modal-content-info-store-selected-content"},i._l(i.allStoresSelected,function(t,e){return t.sotre_name?n("div",{key:e,staticClass:"store-button-content"},[n("span",{staticClass:"store-button"},[i._v(i._s(t.sotre_name))]),i._v(" "),n("i",{staticClass:"deletelabel",on:{click:function(e){i.deleteStoreSelected(t.store_id)}}})]):i._e()}))])])]),i._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:i.next}},[i._v("下一步")]),i._v(" "),n("Button",{staticStyle:{"margin-left":"30px","margin-right":"40%"},attrs:{type:"ghost"},on:{click:i.cancelEditStore}},[i._v("取消")])],1)]),i._v(" "),n("Modal",{staticClass:"edit-store-modal",attrs:{title:"修改店铺权限",width:"800"},model:{value:i.openAddStorePermissionsModal,callback:function(e){i.openAddStorePermissionsModal=e},expression:"openAddStorePermissionsModal"}},[n("div",{staticClass:"edit-store-modal-content"},[n("div",{staticClass:"edit-store-modal-content-save"},[n("p",{staticClass:"edit-store-modal-content-save-title PingFangSC-Medium-font"},[i._v("已添加店铺")]),i._v(" "),i.employeeEdited.storesOfPermissionsAdded.length?n("Menu",{attrs:{"active-name":i.employeeEdited.storesOfPermissionsAdded[0].store_id,theme:"light",width:"auto"},on:{"on-select":i.selectStore}},i._l(i.employeeEdited.storesOfPermissionsAdded,function(e,t){return n("MenuItem",{key:t,attrs:{name:e.store_id}},[i._v("\n                        "+i._s(e.store_name)+"\n                    ")])})):i._e()],1),i._v(" "),n("div",{staticClass:"edit-store-modal-content-save-permission"},[n("div",{staticClass:"store-permission"},[n("p",{staticClass:"title"},[i._v("店铺权限")]),i._v(" "),i._l(i.allInitPermissions,function(s,e){return"0"===s.type?n("div",{key:e,staticClass:"data-center"},[n("div",{directives:[{name:"show",rawName:"v-show",value:i.ifselected,expression:"ifselected"}]},[n("Checkbox",{attrs:{indeterminate:s.indeterminate,value:s.checkAll,disabled:s.disabled},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckAll(s)}}},[i._v("\n                                "+i._s(s.func_group_name)+"\n                            ")]),i._v(" "),n("p",{staticClass:"severed"}),i._v(" "),n("CheckboxGroup",{model:{value:s.permissionIds,callback:function(e){i.$set(s,"permissionIds",e)},expression:"permissionGroup.permissionIds"}},i._l(s.functions,function(t,e){return n("Checkbox",{key:Math.random(),attrs:{disabled:t.disabled,value:t.selected,label:t.id},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckSingle(s,t)}}},[i._v("\n                                    "+i._s(t.func_name)+"\n                                ")])}))],1)]):i._e()})],2)])]),i._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:i.save}},[i._v("保存")]),i._v(" "),n("Button",{staticStyle:{"margin-left":"30px","margin-right":"40%"},attrs:{type:"ghost"},on:{click:i.cancelSaveEditStore}},[i._v("取消\n            ")])],1)]),i._v(" "),n("Modal",{staticClass:"edit-store-modal",attrs:{title:"员工删除",width:"300"},model:{value:i.clerkDepartingModal,callback:function(e){i.clerkDepartingModal=e},expression:"clerkDepartingModal"}},[n("p",{staticClass:"clerk-departing-modal-info"},[i._v("你确定对“"+i._s(i.departingClerkName)+"”员工进行离职操作吗？")]),i._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:i.clerkDeparting}},[i._v("确定")]),i._v(" "),n("Button",{staticStyle:{"margin-left":"30px","margin-right":"56px"},attrs:{type:"ghost"},on:{click:i.cancelClerkDeparting}},[i._v("取消\n            ")])],1)])],1)},staticRenderFns:[]}},1410:function(e,t,s){var i=s(304)(s(1331),s(1332),function(e){s(1329)},null,null);e.exports=i.exports},769:function(e,t,s){e.exports={default:s(775),__esModule:!0}},775:function(e,t,s){s(776),e.exports=s(26).Object.keys},776:function(e,t,s){var i=s(125),n=s(124);s(777)("keys",function(){return function(e){return n(i(e))}})},777:function(e,t,s){var n=s(49),o=s(26),r=s(85);e.exports=function(e,t){var s=(o.Object||{})[e]||Object[e],i={};i[e]=t(s),n(n.S+n.F*r(function(){s(1)}),"Object",i)}},803:function(e,t,s){"use strict";s.d(t,"a",function(){return f});var i=s(311),n=s.n(i),o=s(84),r=s.n(o),a=s(305),l=s.n(a),d=s(306),c=s.n(d),p=s(307),m=s(83),u=s(122),h=s(82),f={data:function(){return{}},methods:{getUserInfoByTokenAction:function(){var s=this;return c()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p._32();case 2:(t=e.sent)&&200===t.code?s.setSession(t):(clearInterval(m.a.clearSetInterval),window.sessionStorage.clear(),u.a.clearAllCookie(h.a.COOKIE_NAME),s.$router.push({path:"/login"}));case 4:case"end":return e.stop()}},e,s)}))()},setSession:function(e){m.a.authToken=e.data.auth_token.toString(),e.data.position&&window.sessionStorage.setItem("position",e.data.position),window.sessionStorage.setItem("token",e.data.auth_token.toString()),0<e.data.stores.length&&window.sessionStorage.setItem("storeToken",e.data.stores[0].store_token),window.sessionStorage.setItem("managementPermissions",e.data.permissions.management.toString()),null!==e.data.permissions.stores?window.sessionStorage.setItem("storesPermissions",r()(e.data.permissions.stores)):m.a.TabMenuShow=!1,e.data.stores&&(window.sessionStorage.setItem("storesList",r()(e.data.stores)),1===e.data.stores.length&&0<e.data.stores.length&&window.sessionStorage.setItem("storeId",e.data.stores[0].store_id)),window.sessionStorage.setItem("userName",e.data.username),this.$store.state.sessionStorageInfo=n()({},window.sessionStorage)}}}},834:function(e,t,s){"use strict";(function(o){t.a={methods:{getCheckboxAbledCounts:function(){this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){e.disabled||(t.checkboxAbledCount+=1)})})},formatAllInitPermissions:function(){this.allInitPermissions.forEach(function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,e.functions.forEach(function(e){e.selected=!1,e.disabled=!1})})},getAllStoresFromAreaSelected:function(t){this.allStoresFromAreaSelected=this.allInitStores.find(function(e){return e.title===t[0].title})},updateStoresSelectedCheckboxState:function(){var t=this;this.allStoresFromAreaSelected.storeGroupIds=[],this.allStoresIdListSelected.length?this.allStoresFromAreaSelected.stores.forEach(function(e){t.allStoresIdListSelected.includes(e.store_id)?(e.selected=!0,t.allStoresFromAreaSelected.storeGroupIds.push(e.store_id),t.allStoresFromAreaSelected.stores.every(function(e){return t.allStoresIdListSelected.includes(e.store_id)})&&t.allStoresFromAreaSelected.stores.length===t.allStoresFromAreaSelected.storeGroupIds.length?(t.allStoresFromAreaSelected.checkAll=!0,t.allStoresFromAreaSelected.indeterminate=!1):(t.allStoresFromAreaSelected.checkAll=!1,t.allStoresFromAreaSelected.indeterminate=!0)):(e.selected=!1,t.allStoresFromAreaSelected.checkAll=!1)}):(this.allStoresFromAreaSelected.checkAll=!1,this.allStoresFromAreaSelected.indeterminate=!1)},next:function(){var i=this;this.allStoresSelected.length?(this.openAddStoresModal=!1,this.openAddStorePermissionsModal=!0,this.employeeEdited.storesOfPermissionsAdded=[],this.allStoresSelected.forEach(function(t){var e=[];if(i.employeeEdited.storesManaged.length){var s=o.find(i.employeeEdited.storesManaged,function(e){return e.store_id===t.store_id});e=void 0!==s?s.permissionsSelected:i.employeeEdited.store_permissions}i.employeeEdited.storesOfPermissionsAdded.push({store_name:t.sotre_name,store_id:t.store_id,store_permissions:i.employeeEdited.store_permissions,permissionsSelected:o.cloneDeep(e)})}),this.selectStore(this.employeeEdited.storesOfPermissionsAdded[0].store_id)):this.$Notice.warning({title:"添加店铺",desc:"请先添加店铺"})},selectStore:function(t){this.ifselected=!1,this.storeIdSelected=t;var e=this.employeeEdited.storesOfPermissionsAdded.find(function(e){return e.store_id===t});this.resetAllInitPermissions(),this.allInitPermissions.forEach(function(e){e.disabled=!0,e.functions.forEach(function(e){e.disabled=!0})}),this.extendPermissionsOfPositionSelected(e),this.getCheckboxAbledCounts(),this.renderCheckboxState(),this.ifselected=!0},resetAllInitPermissions:function(){o.each(this.allInitPermissions,function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,o.each(e.functions,function(e){e.selected=!1,e.disabled=!1})})},extendPermissionsOfPositionSelected:function(e){o.each(this.allInitPermissions,function(s){o.each(s.functions,function(t){o.each(e.store_permissions,function(e){t.id===e&&(t.disabled=!1)}),o.each(e.permissionsSelected,function(e){t.id===e&&(t.selected=!0,s.permissionIds.push(t.id))})})})},renderCheckboxState:function(){this.allInitPermissions.forEach(function(e){0!==e.checkboxAbledCount?e.permissionIds.length===e.checkboxAbledCount?(e.indeterminate=!1,e.disabled=!1,e.checkAll=!0):0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?(e.indeterminate=!0,e.disabled=!1):(e.disabled=!1,e.indeterminate=!1):(e.disabled=!0,e.checkAll=!1)})},extendPermissionsOfDepartmentSelected:function(i){var n=this;this.allInitPermissions.forEach(function(s){s.functions.forEach(function(e){if(i.totalPermissions.length){var t=[];o.isEmpty(n.positionEdited)?(t=i.totalPermissions).includes(e.id)&&(e.disabled=!1,e.selected=!0,s.permissionIds.push(e.id)):(t=o.intersection(i.totalPermissions,n.positionEdited.permissions),i.totalPermissions.includes(e.id)&&(e.disabled=!1),t.includes(e.id)&&(e.selected=!0,s.permissionIds.push(e.id)))}})})}}}}).call(t,s(123))}});