webpackJsonp([25],{1330:function(e,t,s){var n=s(1331);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);s(589)("084c7689",n,!1,{})},1331:function(e,t,s){(e.exports=s(588)()).push([e.i,"\n.edit-store-modal .clerk-departing-modal-info {\n    height: 60px;\n    line-height: 60px;\n    text-align: center;\n}\n.activeMenu {\n    background-color: rgba(188, 197, 202, 0.17);\n}\n.sales-clerk-manage-menu {\n    height: 50px;\n    line-height: 50px;\n    text-align: center;\n    font-size: 14px;\n    color: #7D7D7D;\n    position: relative;\n    cursor: pointer;\n}\n.sales-clerk-manage-menu:hover {\n    background-color: rgba(188, 197, 202, 0.17);\n}\n.sales-clerk-manage-menu .dropdownIcon {\n    display: none;\n}\n.sales-clerk-manage-menu:hover .dropdownIcon {\n    display: inline-block;\n}\n.sales-clerk-manage-menu .ivu-dropdown {\n    position: absolute;\n    right: 20px;\n    height: 30px;\n}\n.sales-clerk-manage-menu .ivu-dropdown-rel {\n    height: 30px;\n}\n\n/* clerk table */\n.sales-clerk-manage-info-content .input-search-content {\n    float: right;\n    height: 32px;\n    width: 200px;\n    display: inline-block;\n    position: relative;\n}\n.sales-clerk-manage-info-content .input-search-content .input-search-icon {\n    position: absolute;\n    right: 6px;\n    top: 6px;\n    z-index: 9;\n    color: #C2C1C1;\n    cursor: pointer;\n}\n.salesclerk-list .salesclerk-table {\n    text-align: center;\n    border-top: 1px solid #DDD;\n    border-left: 1px solid #DDD;\n    cursor: pointer;\n    height: 40px;\n    padding: 0 10px;\n    overflow: hidden;\n}\n.salesclerk-list .salesclerk-table .ivu-poptip-popper {\n    max-width: 276px;\n}\n.salesclerk-list .salesclerk-table span {\n    display: inline-block;\n    line-height: 40px;\n    height: 40px;\n}\n.salesclerk-table .ivu-poptip, .salesclerk-table .ivu-poptip .ivu-poptip-rel {\n    width: 100%;\n    height: 40px;\n}\n.salesclerk-list .salesclerk-table.visit-store {\n    line-height: 40px;\n}\n.salesclerk-list .salesclerk-table.visit-store .ivu-btn {\n    padding: 4px;\n}\n.salesclerk-list .salesclerk-table:last-child {\n    border-right: 1px solid #DDD;\n}\n.salesclerk-list-title, .salesclerk-list:hover {\n    background-color: #F8F8F9;\n}\n.storeListContent span {\n    display: inline-block;\n    padding: 0 6px;\n    height: 30px;\n    line-height: 30px;\n    text-align: center;\n    font-size: 12px;\n    float: left;\n}\n.storeListContent .edit {\n    height: 30px;\n    line-height: 30px;\n    text-align: right;\n    padding-right: 20px;\n    color: #0098CC;\n    cursor: pointer;\n}\nlabel.ivu-checkbox-wrapper-disabled {\n    pointer-events: none !important;\n}\n",""])},1332:function(e,l,d){"use strict";Object.defineProperty(l,"__esModule",{value:!0}),function(i){var e=d(305),A=d.n(e),t=d(306),o=d.n(t),s=d(767),n=d.n(s),y=d(307),r=d(799),a=d(829);l.default={mixins:[r.a,a.a],data:function(){return{storeAreaList:[],ifActionDepartment:!1,ifActionEmployee:!1,managementJson:{},page:1,firstAreaList:[],departingEmployeesCount:0,departingEmployees:[],activeDepartmentId:0,ifselected:!0,storesSelected:[],deleteEmployeeId:"",employeesCount:0,allPositions:[],allDepartments:[],departingClerkName:"",clerkDepartingModal:!1,storeValue:"",saveEditStore:!1,employeeNameSearched:"",storeAddressTree:[],employees:[],allInitPermissions:[],allInitStores:[],allOriginalStoresData:[],allStoresIdListSelected:[],allStoresFromAreaSelected:[],openAddStoresModal:!1,openAddStorePermissionsModal:!1,storesOfPermissionsAdded:[],employeeEdited:{department_id:"",position_id:"",username:"",sex:"1",password:"",rePassword:"",phone:"",stores:[],address:"",identity:"",email:"",employed_time:new Date,director:"",store_permissions:[],position_permissions:[],storesOfPermissionsAdded:[],storesManaged:[],avatar:""},storeIdSelected:[],activeDepartment:{}}},mounted:function(){this.managementJson=JSON.parse(window.sessionStorage.getItem("managementJson")),this.checkManagement(),this.getStoreAddressTree(),this.getAllInitPermissions(),this.getAllDepartments(),this.getAllPositions(),this.getAllEmployees(),this.getAllDepartingEmployees()},computed:{allStoresSelected:function(){var e=this,s=[];return this.allStoresIdListSelected.forEach(function(t){e.allOriginalStoresData.forEach(function(e){t===e.store_id&&s.push(e)})}),s}},methods:{editStoresManagedFromEmployeeSelected:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.openAddStoresModal=!0;var s=i.cloneDeep(e);this.allStoresIdListSelected=n()(s.permissions.stores),this.allStoresIdListSelected=i.map(this.allStoresIdListSelected,function(e){return Number(e)}),s.storesManaged=s.stores;var t=this.allPositions.find(function(e){return e.id===s.position_id});i.each(s.storesManaged,function(e){e.store_permissions=t.store_permissions}),s.store_permissions=s.storesManaged[0].store_permissions,n()(s.permissions.stores).forEach(function(t){s.storesManaged.forEach(function(e){Number(t)===e.store_id&&(e.permissionsSelected=s.permissions.stores[t])})}),s.storesOfPermissionsAdded=[],this.employeeEdited=s,this.selectArea(this.firstAreaList)},selectArea:function(e){this.ifselected=!1,this.getAllStoresFromAreaSelected(e),this.updateStoresSelectedCheckboxState(),this.ifselected=!0},checkManagement:function(){for(var e in this.managementJson)"21"===e&&(this.ifActionDepartment=this.managementJson[e]),"23"===e&&(this.ifActionEmployee=this.managementJson[e])},selectAllEmployees:function(){this.activeDepartmentId=0,this.getAllEmployees(),this.allDepartments.forEach(function(e){e.isActive=!1})},paging:function(e){this.page=e,this.getAllEmployees()},getAllEmployees:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,0!==s.activeDepartmentId){e.next=7;break}return e.next=4,y.R(s.page);case 4:t=e.sent,e.next=10;break;case 7:return e.next=9,y.R(s.page,s.activeDepartmentId);case 9:t=e.sent;case 10:t&&200===t.code&&(s.employeesCount=t.data.total,s.employees=t.data.employees,s.employees.forEach(function(e){var t=[];e.stores.forEach(function(e){t.push(e.store_name)}),e.storesInManagement=t.toString(),"1"===e.sex||null===e.sex?e.gender="男":e.gender="女"}));case 11:case"end":return e.stop()}},e,s)}))()},getAllDepartingEmployees:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.P(1,0);case 2:(t=e.sent)&&200===t.code&&(s.departingEmployeesCount=t.data.total,s.departingEmployees=t.data.employees);case 4:case"end":return e.stop()}},e,s)}))()},getStoreArea:function(e){for(var t in e)e[t].children?this.getStoreArea(e[t].children):this.storeAreaList=this.storeAreaList.concat(e)},getAllDepartments:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.allDepartments=[],e.next=3,y.Q();case 3:(t=e.sent)&&200===t.code&&t.data.forEach(function(e){var t={id:e.id,name:e.name,isActive:!1,permissions:e.permissions,totalPermissions:e.total_permissions};s.allDepartments.push(t)});case 5:case"end":return e.stop()}},e,s)}))()},getAllPositions:function(){var n=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.allPositions=[],e.next=3,y.T(0);case 3:(t=e.sent)&&200===t.code&&t.data.forEach(function(e){var s={};i.forOwn(e.permissions,function(e,t){"string"==typeof e&&(e=""===e?[]:i.map(e.split(","),Number)),s[t]=e}),e.permissions=s;var t={id:e.id,name:e.name,permissions:e.position_permissions,description:e.description,departmentName:e.department_name,departmentAttached:{id:e.department_id,name:e.department_name,permissions:e.department_permissions},management_permissions:e.permissions.management,store_permissions:e.permissions.stores};n.allPositions.push(t)});case 5:case"end":return e.stop()}},e,n)}))()},getStoreAddressTree:function(){var _=this;return o()(A.a.mark(function e(){var t,s,n,i,o,r,a,l,d,c,p,m,u,h,f,g,v,S,k;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s=!(t=[]),e.next=5,y._24();case 5:if((i=e.sent)&&200===i.code)for(o in t=i.data){for(d in r={title:o,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(r),a=[],l=t[o]){for(u in c={title:d,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(c),p=[],m=l[d]){for(g in h={},f=m[u],s?h={title:u,selected:!1}:(h={title:u,selected:!0},s=!0),f)_.allOriginalStoresData=_.allOriginalStoresData.concat(f[g]),f[g].selected=!1;p.push(h),n||(_.firstAreaList.push(h),n=!0),v={title:u,checkAll:!1,indeterminate:!1,stores:[],storeGroupIds:[]},_.allInitStores.push(v),r.stores=r.stores.concat(t[o][d][u]),c.stores=c.stores.concat(t[o][d][u]),v.stores=t[o][d][u]}S={title:d,expand:!0,children:p},a.push(S)}k={title:o,expand:!0,children:a},_.storeAddressTree.push(k)}case 7:case"end":return e.stop()}},e,_)}))()},searchEmployee:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y._49(s.employeeNameSearched);case 2:(t=e.sent)&&200===t.code?(s.employees=t.data,i.each(s.employees,function(e){var t=[];e.stores.length?i.each(e.stores,function(e){t.push(e.store_name)}):t=["暂未添加店铺"],e.storesInManagement=t.toString(),"1"===e.sex?e.gender="女":e.gender="男"})):s.$Message.error("没有该员工！");case 4:case"end":return e.stop()}},e,s)}))()},selectDepartment:function(e){this.allDepartments.forEach(function(e){e.isActive=!1}),e.isActive=!0,this.activeDepartmentId=e.id,this.getAllEmployees(),this.activeDepartment=e},clickDropdown:function(t,s){var n=this;return o()(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"edit"===t?n.editDepartment(s):"delete"===t&&n.deleteDepartment(s);case 1:case"end":return e.stop()}},e,n)}))()},editDepartment:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"creatDepartment",params:{type:"editDepartment",allInitPermissions:this.allInitPermissions,departmentEdited:{id:e.id,name:e.name,totalPermissions:e.totalPermissions}}})},deleteDepartment:function(s){var n=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.T(s.id);case 2:if(!(t=e.sent)||!t.data||0!==t.data.length){e.next=10;break}return e.next=6,y.y(s.id);case 6:e.sent&&(n.$Message.success("删除部门成功"),n.getAllDepartments(),n.selectAllEmployees()),e.next=12;break;case 10:n.$Message.error({content:"该部门下有岗位存在，不能删除该部门",duration:3}),n.selectAllEmployees();case 12:case"end":return e.stop()}},e,n)}))()},addEmployee:function(){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"editEmployee",params:{type:"creatEmployee",allDepartments:this.allDepartments,allPositions:this.allPositions,allInitPermissions:this.allInitPermissions,storeAddressTree:this.storeAddressTree,firstAreaList:this.firstAreaList,allInitStores:this.allInitStores,allOriginalStoresData:this.allOriginalStoresData,activeDepartment:this.activeDepartment,activeDepartmentId:this.activeDepartmentId}})},editEmployee:function(e){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"editEmployee",params:{type:"editEmployee",employee:e,storesSelected:this.storesSelected,allDepartments:this.allDepartments,allPositions:this.allPositions,allInitPermissions:this.allInitPermissions,storeAddressTree:this.storeAddressTree,firstAreaList:this.firstAreaList,allInitStores:this.allInitStores,allOriginalStoresData:this.allOriginalStoresData}})},resignEmployee:function(e){this.departingClerkName=e.username,this.deleteEmployeeId=e.id,this.clerkDepartingModal=!0},deleteStoreSelected:function(s){var n=this;this.allStoresIdListSelected.forEach(function(e,t){e===s&&n.allStoresIdListSelected.splice(t,1)}),this.updateStoresSelectedCheckboxState()},toDepartingClerk:function(){this.$router.push({name:"departingEmployees",params:{departing:this.departingEmployees}})},creatDepartment:function(){this.getAllInitPermissions(),this.formatAllInitPermissions(),this.getCheckboxAbledCounts(),this.$router.push({name:"creatDepartment",params:{type:"creatDepartment",allInitPermissions:this.allInitPermissions}})},getAllInitPermissions:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.S();case 2:(t=e.sent)&&200===t.code&&(s.allInitPermissions=t.data);case 4:case"end":return e.stop()}},e,s)}))()},getCheckboxAbledCounts:function(){this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){e.disabled||(t.checkboxAbledCount+=1)})})},clerkDeparting:function(){var s=this;return o()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y._45(s.deleteEmployeeId);case 2:(t=e.sent)&&200===t.code&&(s.clerkDepartingModal=!1,s.$Message.success("离职成功"),s.getAllEmployees(),s.getAllDepartingEmployees());case 4:case"end":return e.stop()}},e,s)}))()},cancelClerkDeparting:function(){this.clerkDepartingModal=!1},handleCheckAllStore:function(t){var s=this;this.ifselected=!1,t.checkAll=!t.checkAll,t.indeterminate=!1,t.checkAll?(t.storeGroupIds=[],t.stores.forEach(function(e){e.selected=!0,t.storeGroupIds.push(e.store_id),s.allStoresIdListSelected.includes(e.store_id)||s.allStoresIdListSelected.push(e.store_id)})):(t.storeGroupIds=[],t.stores.forEach(function(e){e.selected=!1;var t=s.allStoresIdListSelected.indexOf(e.store_id);-1!==t&&s.allStoresIdListSelected.splice(t,1)})),this.ifselected=!0,this.renderStoreCheckboxState(t)},renderStoreCheckboxState:function(e){e.storeGroupIds.length===e.stores.length?(e.checkAll=!0,e.indeterminate=!1):0<e.storeGroupIds.length&&e.storeGroupIds.length<e.stores.length?(e.checkAll=!1,e.indeterminate=!0):(e.checkAll=!1,e.indeterminate=!1)},handleCheckSingleStore:function(e,t){this.ifselected=!1;var s=e.storeGroupIds.indexOf(t.store_id);if(-1!==s){t.selected=!1,e.storeGroupIds.splice(s,1);var n=this.allStoresIdListSelected.indexOf(t.store_id);-1!==n&&this.allStoresIdListSelected.splice(n,1)}else t.selected=!0,e.storeGroupIds.push(t.store_id),this.allStoresIdListSelected.includes(t.store_id)||this.allStoresIdListSelected.push(t.store_id);e.storeGroupIds.length===e.stores.length?(e.checkAll=!0,e.indeterminate=!1):0<e.storeGroupIds.length&&e.storeGroupIds.length<e.stores.length?(e.checkAll=!1,e.indeterminate=!0):e.indeterminate=!1,this.renderStoreCheckboxState(e),this.ifselected=!0},submit:function(){var t,r=this;this.$refs.employeeEdited.validate((t=o()(A.a.mark(function e(t){var s,n,i,o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=17;break}if(s=[],r.employeeEdited.storesManaged.length?r.employeeEdited.storesManaged.forEach(function(e){s.push({id:e.store_id,name:e.store_name,permissions:e.permissionsSelected})}):r.$Message.error({content:"未添加店铺",duration:3}),n=void 0,n=r.employeeEdited.employed_time?parseInt(Number(r.employeeEdited.employed_time.getTime())/1e3):parseInt((new Date).getTime()/1e3),"添加员工"!==r.employeeOperationType){e.next=10;break}return e.next=8,y.m(r.employeeEdited.position_id,r.employeeEdited.department_id,r.employeeEdited.username,r.employeeEdited.password,r.employeeEdited.sex,r.employeeEdited.phone,s,r.employeeEdited.avatar,r.employeeEdited.address,r.employeeEdited.identity,r.employeeEdited.email,n,r.employeeEdited.director);case 8:(i=e.sent)&&200===i.code&&(r.$router.push("/salesclerkManage/clerkManage/department"),r.$Message.success("添加员工成功!"));case 10:if("编辑员工"!==r.employeeOperationType){e.next=15;break}return e.next=13,y._55(r.employeeEdited.id,r.employeeEdited.position_id,r.employeeEdited.department_id,r.employeeEdited.username,r.employeeEdited.password,r.employeeEdited.sex,r.employeeEdited.phone,s,r.employeeEdited.avatar,r.employeeEdited.address,r.employeeEdited.identity,r.employeeEdited.email,n,r.employeeEdited.director);case 13:(o=e.sent)&&200===o.code&&(r.$router.push("/salesclerkManage/clerkManage/department"),r.$Message.success("编辑员工成功!"));case 15:e.next=18;break;case 17:r.$Message.error("表单验证失败!");case 18:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},cancelEditStore:function(){this.storesAddedIsSaved||(this.allStoresFromAreaSelected={},this.allStoresIdListSelected=[]),this.openAddStoresModal=!1},handleCheckAll:function(e){var n=this;this.ifselected=!1,e.checkAll=!e.checkAll,e.indeterminate=!1,e.disabled||(e.checkAll?(e.permissionIds=[],e.functions.forEach(function(t){t.disabled||(t.selected=!0,e.permissionIds.push(t.id),n.employeeEdited.storesOfPermissionsAdded.forEach(function(e){e.store_id===n.storeIdSelected&&(e.permissionsSelected.includes(t.id)||e.permissionsSelected.push(t.id))}))})):(e.permissionIds=[],e.functions.forEach(function(s){s.disabled||(s.selected=!1,n.employeeEdited.storesOfPermissionsAdded.forEach(function(e){if(e.store_id===n.storeIdSelected){var t=e.permissionsSelected.indexOf(s.id);-1!==t&&e.permissionsSelected.splice(t,1)}}))}))),this.renderCheckboxState(),this.updatePermissionsSelectedFromStoreSelected(this.storeIdSelected),this.ifselected=!0},handleCheckSingle:function(e,s){var n=this;this.ifselected=!1;var t=e.permissionIds.indexOf(s.id);-1!==t?(s.selected=!1,e.permissionIds.splice(t,1),this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){if(e.store_id===n.storeIdSelected){var t=e.permissionsSelected.indexOf(s.id);-1!==t&&e.permissionsSelected.splice(t,1)}})):(s.selected=!0,e.permissionIds.push(s.id),this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){e.store_id===n.storeIdSelected&&e.permissionsSelected.push(s.id)})),e.permissionIds.length===e.checkboxAbledCount?e.checkAll=!0:e.checkAll=!1,0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?e.indeterminate=!0:e.indeterminate=!1,this.renderCheckboxState(),this.updatePermissionsSelectedFromStoreSelected(this.storeIdSelected),this.ifselected=!0},updatePermissionsSelectedFromStoreSelected:function(t){var s={};this.employeeEdited.storesOfPermissionsAdded.forEach(function(e){t===e.store_id&&(s=e)}),this.allInitPermissions.forEach(function(e){e.checkAll?e.functions.forEach(function(e){s.permissionsSelected.includes(e.id)||s.permissionsSelected.push(e.id)}):e.functions.forEach(function(e){if(s.permissionsSelected.includes(e.id)){var t=s.permissionsSelected.indexOf(e.id);s.permissionsSelected.splice(t,1)}}),e.functions.forEach(function(e){if(e.selected&&!s.permissionsSelected.includes(e.id)&&s.permissionsSelected.push(e.id),!e.selected&&s.permissionsSelected.includes(e.id)){var t=s.permissionsSelected.indexOf(e.id);s.permissionsSelected.splice(t,1)}})})},cancelSaveEditStore:function(){this.storesAddedIsSaved||(this.allStoresFromAreaSelected={},this.allStoresIdListSelected=[],this.employeeEdited.storesManaged=[]),this.openAddStorePermissionsModal=!1},save:function(){var n=this;return o()(A.a.mark(function e(){var t,s;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.employeeEdited.storesManaged=i.cloneDeep(n.employeeEdited.storesOfPermissionsAdded),t=[],n.employeeEdited.storesManaged.length&&n.employeeEdited.storesManaged.forEach(function(e){t.push({id:e.store_id,name:e.store_name,permissions:e.permissionsSelected})}),n.employeeEdited.storesOfPermissionsAdded.length=0,n.storesAddedIsSaved=!0,n.openAddStorePermissionsModal=!1,e.next=8,y._57(t,n.employeeEdited.id);case 8:(s=e.sent)&&200===s.code?(n.saveEditStore=!1,n.$Message.success("保存成功"),n.getUserInfoByTokenAction(),n.getAllEmployees()):n.$Message.error(s.error_msg);case 10:case"end":return e.stop()}},e,n)}))()}}}}.call(l,d(122))},1333:function(e,t,s){e.exports={render:function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("Row",[i("Col",{staticClass:"layout-menu-left",attrs:{span:"3"}},[i("p",{staticClass:"sales-clerk-manage-content-department PingFangSC-Medium-font"},[n._v("\n            部门\n            "),n.ifActionDepartment?i("Button",{attrs:{type:"ghost"},on:{click:n.creatDepartment}},[n._v("新建")]):n._e()],1),n._v(" "),i("p",{staticClass:"sales-clerk-manage-all",on:{click:n.selectAllEmployees}},[n._v("全部员工")]),n._v(" "),i("div",n._l(n.allDepartments,function(t,e){return i("p",{key:e,staticClass:"sales-clerk-manage-menu",class:{activeMenu:t.isActive},on:{click:function(e){n.selectDepartment(t)}}},[n._v(n._s(t.name)+"\n                "),n.ifActionDepartment?i("Dropdown",{staticClass:"dropdownIcon"},[i("Icon",{attrs:{type:"gear-b"}}),n._v(" "),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[i("DropdownItem",{attrs:{name:"修改"},nativeOn:{click:function(e){e.preventDefault(),n.clickDropdown("edit",t)}}},[n._v("\n                            修改\n                        ")]),n._v(" "),i("DropdownItem",{attrs:{name:"删除"},nativeOn:{click:function(e){e.preventDefault(),n.clickDropdown("delete",t)}}},[n._v("删除\n                        ")])],1)],1):n._e()],1)}))]),n._v(" "),i("Col",{staticClass:"sales-clerk-manage-info",attrs:{span:"21"}},[i("div",{staticClass:"sales-clerk-manage-info-main"},[i("p",{staticClass:"sales-clerk-manage-info-title"},[i("span",{staticClass:"current-clerk"},[n._v("当前员工 ("+n._s(n.employeesCount)+")")]),i("span",{staticClass:"look-departing-employees",on:{click:n.toDepartingClerk}},[n._v("查看离职员工("+n._s(n.departingEmployeesCount)+")")])]),n._v(" "),i("div",{staticClass:"sales-clerk-manage-info-content"},[i("p",{staticClass:"search-content"},[n.ifActionEmployee?i("Button",{attrs:{type:"primary"},on:{click:n.addEmployee}},[n._v("添加员工")]):n._e(),n._v(" "),i("span",{staticClass:"input-search-content"},[i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入员工姓名"},on:{"on-enter":n.searchEmployee},model:{value:n.employeeNameSearched,callback:function(e){n.employeeNameSearched=e},expression:"employeeNameSearched"}}),n._v(" "),i("Icon",{staticClass:"input-search-icon",attrs:{type:"search",size:"18"},nativeOn:{click:function(e){return n.searchEmployee(e)}}})],1)],1),n._v(" "),i("Row",{staticClass:"salesclerk-list salesclerk-list-title"},[i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[i("span",[n._v("序号")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[i("span",[n._v("工号")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[i("span",[n._v("姓名")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:n.ifActionEmployee?3:5}},[i("span",[n._v("账号名")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[i("span",[n._v("性别")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[i("span",[n._v("部门")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[i("span",[n._v("岗位")])]),n._v(" "),i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"3"}},[i("span",[n._v("店铺")])]),n._v(" "),n.ifActionEmployee?i("Col",{staticClass:"salesclerk-table PingFangSC-Medium-font",attrs:{span:"2"}},[i("span",[n._v("操作")])]):n._e()],1),n._v(" "),n._l(n.employees,function(t,e){return i("Row",{key:e,staticClass:"salesclerk-list"},[i("Col",{staticClass:"salesclerk-table",attrs:{span:"2"}},[i("span",[n._v(n._s(e+1))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[i("span",[n._v(n._s(t.serial))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[i("span",[n._v(n._s(t.username))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:n.ifActionEmployee?3:5}},[i("span",[n._v(n._s(t.username))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"2"}},[i("span",[n._v(n._s(t.gender))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[i("span",[n._v(n._s(t.department_name))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[i("span",[n._v(n._s(t.position_name))])]),n._v(" "),i("Col",{staticClass:"salesclerk-table",attrs:{span:"3"}},[i("Poptip",{attrs:{trigger:"hover",placement:"bottom",width:"100px"}},[i("span",[n._v(n._s(t.storesInManagement))]),n._v(" "),i("div",{staticClass:"storeListContent",attrs:{slot:"content"},slot:"content"},[i("div",{staticStyle:{overflow:"hidden"}},n._l(t.stores,function(e){return i("span",[n._v(n._s(e.store_name))])})),n._v(" "),n.ifActionEmployee?i("p",{staticClass:"edit",on:{click:function(e){n.editStoresManagedFromEmployeeSelected(t)}}},[n._v("修改店铺")]):n._e()])])],1),n._v(" "),n.ifActionEmployee?i("Col",{staticClass:"salesclerk-table visit-store",attrs:{span:"2"}},[i("Button",{attrs:{type:"text",icon:"edit"},on:{click:function(e){n.editEmployee(t)}}}),n._v(" "),i("Button",{attrs:{type:"text",icon:"android-delete"},on:{click:function(e){n.resignEmployee(t)}}})],1):n._e()],1)}),n._v(" "),i("p",{staticClass:"page"},[i("Page",{attrs:{total:1,"show-total":"","show-elevator":""},on:{"on-change":n.paging}})],1)],2)])]),n._v(" "),i("Modal",{staticClass:"edit-store-modal",attrs:{title:"修改店铺",width:"800"},model:{value:n.openAddStoresModal,callback:function(e){n.openAddStoresModal=e},expression:"openAddStoresModal"}},[i("div",{staticClass:"edit-store-modal-content"},[i("div",{staticClass:"edit-store-modal-content-tree"},[i("p",{staticClass:"edit-store-modal-content-tree-title PingFangSC-Medium-font"},[n._v("区域")]),n._v(" "),i("Tree",{attrs:{data:n.storeAddressTree},on:{"on-select-change":n.selectArea}})],1),n._v(" "),i("div",{staticClass:"edit-store-modal-content-info"},[i("div",{staticClass:"edit-store-modal-content-info-store"},[i("Input",{attrs:{placeholder:"请输入..."},model:{value:n.storeValue,callback:function(e){n.storeValue=e},expression:"storeValue"}}),n._v(" "),i("Checkbox",{attrs:{value:n.allStoresFromAreaSelected.checkAll,indeterminate:n.allStoresFromAreaSelected.indeterminate},nativeOn:{click:function(e){e.preventDefault(),n.handleCheckAllStore(n.allStoresFromAreaSelected)}}},[n._v("\n                        全选\n                    ")]),n._v(" "),n._l(n.allStoresFromAreaSelected.stores,function(t,e){return i("div",{directives:[{name:"show",rawName:"v-show",value:n.ifselected,expression:"ifselected"}],key:e},[i("CheckboxGroup",{staticStyle:{float:"left"},model:{value:n.allStoresFromAreaSelected.storeGroupIds,callback:function(e){n.$set(n.allStoresFromAreaSelected,"storeGroupIds",e)},expression:"allStoresFromAreaSelected.storeGroupIds"}},[i("Checkbox",{key:Math.random(),attrs:{value:t.selected,label:t.store_id},nativeOn:{click:function(e){e.preventDefault(),n.handleCheckSingleStore(n.allStoresFromAreaSelected,t)}}},[n._v("\n                                "+n._s(t.sotre_name)+"\n                            ")])],1)],1)})],2),n._v(" "),i("div",{staticClass:"edit-store-modal-content-info-store-selected"},[i("p",{staticClass:"edit-store-modal-content-info-store-selected-title PingFangSC-Medium-font"},[n._v("已添加店铺")]),n._v(" "),i("div",{staticClass:"edit-store-modal-content-info-store-selected-content"},n._l(n.allStoresSelected,function(t,e){return t.sotre_name?i("div",{key:e,staticClass:"store-button-content"},[i("span",{staticClass:"store-button"},[n._v(n._s(t.sotre_name))]),n._v(" "),i("i",{staticClass:"deletelabel",on:{click:function(e){n.deleteStoreSelected(t.store_id)}}})]):n._e()}))])])]),n._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:n.next}},[n._v("下一步")]),n._v(" "),i("Button",{staticStyle:{"margin-left":"30px","margin-right":"40%"},attrs:{type:"ghost"},on:{click:n.cancelEditStore}},[n._v("取消")])],1)]),n._v(" "),i("Modal",{staticClass:"edit-store-modal",attrs:{title:"修改店铺权限",width:"800"},model:{value:n.openAddStorePermissionsModal,callback:function(e){n.openAddStorePermissionsModal=e},expression:"openAddStorePermissionsModal"}},[i("div",{staticClass:"edit-store-modal-content"},[i("div",{staticClass:"edit-store-modal-content-save"},[i("p",{staticClass:"edit-store-modal-content-save-title PingFangSC-Medium-font"},[n._v("已添加店铺")]),n._v(" "),n.employeeEdited.storesOfPermissionsAdded.length?i("Menu",{attrs:{"active-name":n.employeeEdited.storesOfPermissionsAdded[0].store_id,theme:"light",width:"auto"},on:{"on-select":n.selectStore}},n._l(n.employeeEdited.storesOfPermissionsAdded,function(e,t){return i("MenuItem",{key:t,attrs:{name:e.store_id}},[n._v("\n                        "+n._s(e.store_name)+"\n                    ")])})):n._e()],1),n._v(" "),i("div",{staticClass:"edit-store-modal-content-save-permission"},[i("div",{staticClass:"store-permission"},[i("p",{staticClass:"title"},[n._v("店铺权限")]),n._v(" "),n._l(n.allInitPermissions,function(s,e){return"0"===s.type?i("div",{key:e,staticClass:"data-center"},[i("div",{directives:[{name:"show",rawName:"v-show",value:n.ifselected,expression:"ifselected"}]},[i("Checkbox",{attrs:{indeterminate:s.indeterminate,value:s.checkAll,disabled:s.disabled},nativeOn:{click:function(e){e.preventDefault(),n.handleCheckAll(s)}}},[n._v("\n                                "+n._s(s.func_group_name)+"\n                            ")]),n._v(" "),i("p",{staticClass:"severed"}),n._v(" "),i("CheckboxGroup",{model:{value:s.permissionIds,callback:function(e){n.$set(s,"permissionIds",e)},expression:"permissionGroup.permissionIds"}},n._l(s.functions,function(t,e){return i("Checkbox",{key:Math.random(),attrs:{disabled:t.disabled,value:t.selected,label:t.id},nativeOn:{click:function(e){e.preventDefault(),n.handleCheckSingle(s,t)}}},[n._v("\n                                    "+n._s(t.func_name)+"\n                                ")])}))],1)]):n._e()})],2)])]),n._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:n.save}},[n._v("保存")]),n._v(" "),i("Button",{staticStyle:{"margin-left":"30px","margin-right":"40%"},attrs:{type:"ghost"},on:{click:n.cancelSaveEditStore}},[n._v("取消\n            ")])],1)]),n._v(" "),i("Modal",{staticClass:"edit-store-modal",attrs:{title:"员工删除",width:"300"},model:{value:n.clerkDepartingModal,callback:function(e){n.clerkDepartingModal=e},expression:"clerkDepartingModal"}},[i("p",{staticClass:"clerk-departing-modal-info"},[n._v("你确定对“"+n._s(n.departingClerkName)+"”员工进行离职操作吗？")]),n._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:n.clerkDeparting}},[n._v("确定")]),n._v(" "),i("Button",{staticStyle:{"margin-left":"30px","margin-right":"56px"},attrs:{type:"ghost"},on:{click:n.cancelClerkDeparting}},[n._v("取消\n            ")])],1)])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},1411:function(e,t,s){var n=!1;var i=s(304)(s(1332),s(1333),function(e){n||s(1330)},null,null);i.options.__file="/Users/zhouqichao/Desktop/sxkj/shangu_online/src/components/views/salesclerkManage/children/department.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] department.vue: functional components are not supported with templates, they should use render functions."),e.exports=i.exports},767:function(e,t,s){e.exports={default:s(769),__esModule:!0}},769:function(e,t,s){s(770),e.exports=s(31).Object.keys},770:function(e,t,s){var n=s(124),i=s(123);s(771)("keys",function(){return function(e){return i(n(e))}})},771:function(e,t,s){var i=s(49),o=s(31),r=s(84);e.exports=function(e,t){var s=(o.Object||{})[e]||Object[e],n={};n[e]=t(s),i(i.S+i.F*r(function(){s(1)}),"Object",n)}},799:function(e,t,s){"use strict";s.d(t,"a",function(){return f});var n=s(309),i=s.n(n),o=s(83),r=s.n(o),a=s(305),l=s.n(a),d=s(306),c=s.n(d),p=s(307),m=s(82),u=s(121),h=s(81),f={data:function(){return{}},methods:{getUserInfoByTokenAction:function(){var s=this;return c()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p._33();case 2:(t=e.sent)&&200===t.code?s.setSession(t):(clearInterval(m.a.clearSetInterval),window.sessionStorage.clear(),u.a.clearAllCookie(h.a.COOKIE_NAME),s.$router.push({path:"/login"}));case 4:case"end":return e.stop()}},e,s)}))()},setSession:function(e){m.a.authToken=e.data.auth_token.toString(),e.data.position&&window.sessionStorage.setItem("position",e.data.position),window.sessionStorage.setItem("token",e.data.auth_token.toString()),0<e.data.stores.length&&window.sessionStorage.setItem("storeToken",e.data.stores[0].store_token),window.sessionStorage.setItem("managementPermissions",e.data.permissions.management.toString()),null!==e.data.permissions.stores?window.sessionStorage.setItem("storesPermissions",r()(e.data.permissions.stores)):m.a.TabMenuShow=!1,e.data.stores&&(window.sessionStorage.setItem("storesList",r()(e.data.stores)),1===e.data.stores.length&&0<e.data.stores.length&&window.sessionStorage.setItem("storeId",e.data.stores[0].store_id)),window.sessionStorage.setItem("userName",e.data.username),this.$store.state.sessionStorageInfo=i()({},window.sessionStorage)}}}},829:function(e,t,s){"use strict";(function(o){t.a={methods:{getCheckboxAbledCounts:function(){this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){e.disabled||(t.checkboxAbledCount+=1)})})},formatAllInitPermissions:function(){this.allInitPermissions.forEach(function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,e.functions.forEach(function(e){e.selected=!1,e.disabled=!1})})},getAllStoresFromAreaSelected:function(t){this.allStoresFromAreaSelected=this.allInitStores.find(function(e){return e.title===t[0].title})},updateStoresSelectedCheckboxState:function(){var t=this;this.allStoresFromAreaSelected.storeGroupIds=[],this.allStoresIdListSelected.length?this.allStoresFromAreaSelected.stores.forEach(function(e){t.allStoresIdListSelected.includes(e.store_id)?(e.selected=!0,t.allStoresFromAreaSelected.storeGroupIds.push(e.store_id),t.allStoresFromAreaSelected.stores.every(function(e){return t.allStoresIdListSelected.includes(e.store_id)})&&t.allStoresFromAreaSelected.stores.length===t.allStoresFromAreaSelected.storeGroupIds.length?(t.allStoresFromAreaSelected.checkAll=!0,t.allStoresFromAreaSelected.indeterminate=!1):(t.allStoresFromAreaSelected.checkAll=!1,t.allStoresFromAreaSelected.indeterminate=!0)):(e.selected=!1,t.allStoresFromAreaSelected.checkAll=!1)}):(this.allStoresFromAreaSelected.checkAll=!1,this.allStoresFromAreaSelected.indeterminate=!1)},next:function(){var n=this;this.allStoresSelected.length?(this.openAddStoresModal=!1,this.openAddStorePermissionsModal=!0,this.employeeEdited.storesOfPermissionsAdded=[],this.allStoresSelected.forEach(function(t){var e=[];if(n.employeeEdited.storesManaged.length){var s=o.find(n.employeeEdited.storesManaged,function(e){return e.store_id===t.store_id});e=void 0!==s?s.permissionsSelected:n.employeeEdited.store_permissions}n.employeeEdited.storesOfPermissionsAdded.push({store_name:t.sotre_name,store_id:t.store_id,store_permissions:n.employeeEdited.store_permissions,permissionsSelected:o.cloneDeep(e)})}),this.selectStore(this.employeeEdited.storesOfPermissionsAdded[0].store_id)):this.$Notice.warning({title:"添加店铺",desc:"请先添加店铺"})},selectStore:function(t){this.ifselected=!1,this.storeIdSelected=t;var e=this.employeeEdited.storesOfPermissionsAdded.find(function(e){return e.store_id===t});this.resetAllInitPermissions(),this.allInitPermissions.forEach(function(e){e.disabled=!0,e.functions.forEach(function(e){e.disabled=!0})}),this.extendPermissionsOfPositionSelected(e),this.getCheckboxAbledCounts(),this.renderCheckboxState(),this.ifselected=!0},resetAllInitPermissions:function(){o.each(this.allInitPermissions,function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,o.each(e.functions,function(e){e.selected=!1,e.disabled=!1})})},extendPermissionsOfPositionSelected:function(e){o.each(this.allInitPermissions,function(s){o.each(s.functions,function(t){o.each(e.store_permissions,function(e){t.id===e&&(t.disabled=!1)}),o.each(e.permissionsSelected,function(e){t.id===e&&(t.selected=!0,s.permissionIds.push(t.id))})})})},renderCheckboxState:function(){this.allInitPermissions.forEach(function(e){0!==e.checkboxAbledCount?e.permissionIds.length===e.checkboxAbledCount?(e.indeterminate=!1,e.disabled=!1,e.checkAll=!0):0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?(e.indeterminate=!0,e.disabled=!1):(e.disabled=!1,e.indeterminate=!1):(e.disabled=!0,e.checkAll=!1)})},extendPermissionsOfDepartmentSelected:function(n){var i=this;this.allInitPermissions.forEach(function(s){s.functions.forEach(function(e){if(n.totalPermissions.length){var t=[];o.isEmpty(i.positionEdited)?(t=n.totalPermissions).includes(e.id)&&(e.disabled=!1,e.selected=!0,s.permissionIds.push(e.id)):(t=o.intersection(n.totalPermissions,i.positionEdited.permissions),n.totalPermissions.includes(e.id)&&(e.disabled=!1),t.includes(e.id)&&(e.selected=!0,s.permissionIds.push(e.id)))}})})}}}}).call(t,s(122))}});