webpackJsonp([34],{1318:function(e,t,n){var i=n(1319);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(589)("368cbfe8",i,!1,{})},1319:function(e,t,n){(e.exports=n(588)()).push([e.i,"\n.creat-department .creat-new-department-title[data-v-401dd738] {\n    height: 50px;\n    line-height: 50px;\n    padding-left: 30px;\n    border-bottom: 1px solid #DDDDDD;\n    font-size: 16px;\n}\n.creat-department .creat-department-content[data-v-401dd738] {\n    padding-bottom: 30px;\n    overflow: hidden;\n}\n\n/* creat department */\n.creat-department .creat-new-department[data-v-401dd738] {\n    width: 38%;\n    float: left;\n    margin-right: 2%;\n    border: 1px solid #DDDDDD;\n    min-height: 652px;\n}\n.creat-department .creat-new-department .ivu-form.ivu-form-label-right[data-v-401dd738] {\n    width: 90%;\n    margin: 30px auto;\n}\n.creat-department .creat-new-department .creat-new-department-title[data-v-401dd738] {\n    height: 40px;\n    line-height: 40px;\n    padding-left: 15px;\n    background-color: #F2F2F5;\n    font-size: 14px;\n}\n.creat-department .creat-new-department .department-name[data-v-401dd738] {\n    height: 50px;\n    line-height: 50px;\n    text-align: center;\n    margin-top: 20px;\n}\n.creat-department .creat-new-department .department-name span[data-v-401dd738] {\n    width: 80px;\n    height: 50px;\n    line-height: 50px;\n    display: inline-block;\n    font-size: 12px;\n}\n.creat-department .creat-new-department .department-name .ivu-input-wrapper[data-v-401dd738] {\n    width: 50%;\n}\n\n/* setting permission */\n.creat-department .setting-permission[data-v-401dd738] {\n    width: 60%;\n    float: left;\n    border: 1px solid #DDDDDD;\n    min-height: 652px;\n}\n.creat-department .setting-permission .setting-permission-title[data-v-401dd738] {\n    height: 40px;\n    line-height: 40px;\n    padding-left: 15px;\n    background-color: #F2F2F5;\n    font-size: 14px;\n}\n.creat-department .setting-permission .setting-permission-content[data-v-401dd738] {\n    padding: 30px;\n}\n.creat-department .setting-permission .store-permission[data-v-401dd738] {\n    margin-bottom: 20px;\n}\n.creat-department .setting-permission .permission[data-v-401dd738] {\n    height: 260px;\n    border: 1px solid #DDDDDD;\n    overflow: auto;\n    scrollbar-face-color: #DDD;\n    scrollbar-highlight-color: #0099CC;\n}\n.creat-department .setting-permission .permission[data-v-401dd738]::-webkit-scrollbar {\n    background-color: #DDD;\n    width: 3px;\n}\n.creat-department .setting-permission .permission[data-v-401dd738]::-webkit-scrollbar-thumb {\n    background-color: #0099CC;\n    border-radius: 2px;\n}\n.creat-department .setting-permission .setting-permission-content .title[data-v-401dd738] {\n    height: 50px;\n    line-height: 50px;\n    padding-left: 15px;\n    font-size: 14px;\n}\n\n/* data center */\n.creat-department .setting-permission .data-center[data-v-401dd738] {\n    padding: 0 30px 30px;\n}\n.creat-department .setting-permission .severed[data-v-401dd738] {\n    height: 1px;\n    margin-left: 50px;\n    background-color: #DDDDDD;\n    margin-top: 10px;\n    margin-bottom: 10px;\n}\n.creat-department .setting-permission .ivu-checkbox-group[data-v-401dd738] {\n    padding-left: 40px;\n}\n\n/* operation analyze */\n.creat-department .setting-permission .operation-analyze[data-v-401dd738] {\n    margin-top: 40px;\n}\n\n/* operation button */\n.creat-department .operation-button[data-v-401dd738] {\n    height: 50px;\n    line-height: 50px;\n    text-align: center;\n    margin-bottom: 40px;\n}\n.creat-department .operation-button .ivu-btn.ivu-btn-primary[data-v-401dd738] {\n    margin-right: 30px;\n}\n\n/* checkbox color */\n.creat-department .ivu-checkbox-checked .ivu-checkbox-inner[data-v-401dd738] {\n    border-color: #0098CA;\n    background-color: #0098CA;\n}\nlabel.ivu-checkbox-wrapper-disabled[data-v-401dd738] {\n    pointer-events: none!important;\n}\n",""])},1320:function(e,o,d){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),function(e){var t=d(305),s=d.n(t),n=d(306),r=d.n(n),a=d(307),i=d(829);o.default={mixins:[i.a],data:function(){return{departmentEdited:{},allDepartments:[],positionEdited:{},allManagerPermissionsId:[],allStorePermissionsId:[],ifselected:!0,ifCreatPosition:!0,ifCreatDepartment:!0,ifDepartment:!1,departmentName:"",position:{departmentIdAttached:"",name:"",desc:""},allInitPermissions:[],ruleValidate:{name:[{required:!0,message:"岗位不能为空",trigger:"blur"}],departmentIdAttached:[{required:!0}]}}},mounted:function(){"creatDepartment"===this.$route.params.type&&this.receiveCreatDepartment(),"editDepartment"===this.$route.params.type&&this.receiveEditDepartment(),"creatPosition"===this.$route.params.type&&this.receiveCreatPosition(),"editPosition"===this.$route.params.type&&this.receiveEditPosition()},methods:{receiveCreatDepartment:function(){"creatDepartment"===this.$route.params.type&&(this.ifDepartment=!0,this.ifCreatDepartment=!0,this.allInitPermissions=this.$route.params.allInitPermissions,this.classifyAllInitPermissions())},receiveEditDepartment:function(){"editDepartment"===this.$route.params.type&&(this.ifDepartment=!0,this.ifCreatDepartment=!1,e.isEmpty(this.$route.params.departmentEdited)||(this.departmentEdited=this.$route.params.departmentEdited),this.allInitPermissions=this.$route.params.allInitPermissions,this.classifyAllInitPermissions(),this.formatDepartmentEditedPermissions(),this.renderCheckboxState())},receiveCreatPosition:function(){this.ifDepartment=!1,this.ifCreatPosition=!0,this.allDepartments=this.$route.params.allDepartments,this.allInitPermissions=this.$route.params.allInitPermissions,this.classifyAllInitPermissions(),this.position.departmentIdAttached=this.allDepartments[0].id,this.selectDepartment(this.allDepartments[0])},receiveEditPosition:function(){var t=this;"editPosition"===this.$route.params.type&&(this.ifDepartment=!1,this.ifCreatPosition=!1,this.$route.params.allDepartments&&(this.allDepartments=this.$route.params.allDepartments,this.allInitPermissions=this.$route.params.allInitPermissions),e.isEmpty(this.$route.params.positionEdited)||(this.positionEdited=this.$route.params.positionEdited),this.position.departmentIdAttached=this.positionEdited.departmentAttached.id,this.position.name=this.positionEdited.name,this.position.desc=this.positionEdited.description,this.allInitPermissions=this.$route.params.allInitPermissions,this.allDepartments=this.$route.params.allDepartments,this.classifyAllInitPermissions(),this.formatPositionPermissions(),this.allDepartments.forEach(function(e){e.id===t.positionEdited.departmentAttached.id&&t.selectDepartment(e)}))},selectDepartment:function(e){this.resetAllInitPermissions(),this.allInitPermissions.forEach(function(e){e.disabled=!0,e.functions.forEach(function(e){e.disabled=!0})}),this.extendPermissionsOfDepartmentSelected(e),this.getCheckboxAbledCounts(),this.renderCheckboxState()},resetAllInitPermissions:function(){this.allInitPermissions.forEach(function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,e.functions.forEach(function(e){e.selected=!1,e.disabled=!1})})},classifyAllInitPermissions:function(){var n=[],i=[];this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){"1"===t.type?n.push(e.id):i.push(e.id)})}),this.allManagerPermissionsId=n,this.allStorePermissionsId=i},formatDepartmentEditedPermissions:function(){var n=this;this.allInitPermissions.forEach(function(e){var t=[];e.functions.forEach(function(e){n.departmentEdited.totalPermissions.length&&n.departmentEdited.totalPermissions.includes(e.id)&&(e.selected=!0,t.push(e.id))}),e.permissionIds=t})},formatPositionPermissions:function(){var i=this;this.allInitPermissions.forEach(function(e){var n=[];e.functions.forEach(function(t){i.positionEdited.permissions.length&&i.positionEdited.permissions.forEach(function(e){e===t.id&&(t.selected=!0,n.push(e))})}),e.permissionIds=n})},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},save:function(){var t=this,n=[],i=[];this.allInitPermissions.forEach(function(e){e.permissionIds.forEach(function(e){t.allManagerPermissionsId.includes(e)&&n.push(e),t.allStorePermissionsId.includes(e)&&i.push(e)})});var e={management:n,stores:i};this.ifDepartment?this.ifCreatDepartment&&0<this.trim(this.departmentName).length?this.sendCreatDepartmentRequest(e):!this.ifCreatDepartment&&0<this.trim(this.departmentEdited.name).length?this.sendEditDepartmentRequest(e):this.$Notice.warning({title:"部门操作",desc:"部门名称不能为空"}):0<this.trim(this.position.name).length?this.ifCreatPosition?this.sendCreatPositionRequest(e):this.sendEditPositionRequest(e):this.$Notice.warning({title:"岗位操作",desc:"岗位和部门不能为空"})},sendCreatDepartmentRequest:function(n){var i=this;return r()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.l(i.departmentName,n);case 2:(t=e.sent)&&200===t.code?(i.$Message.success("添加部门成功！"),i.$router.push({name:"department"})):i.$Message.error("添加部门失败！");case 4:case"end":return e.stop()}},e,i)}))()},sendEditDepartmentRequest:function(n){var i=this;return r()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._53(i.departmentEdited.id,i.departmentEdited.name,n);case 2:(t=e.sent)&&200===t.code?(i.$Message.success("修改部门成功！"),i.$router.push({name:"department"})):i.$Message.error("修改部门失败！");case 4:case"end":return e.stop()}},e,i)}))()},sendCreatPositionRequest:function(n){var i=this;return r()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.n(i.position.departmentIdAttached,i.position.name,n,i.position.desc);case 2:(t=e.sent)&&200===t.code?(i.$Message.success("创建岗位成功！"),i.$router.push({name:"position"})):i.$Message.error("创建岗位失败！");case 4:case"end":return e.stop()}},e,i)}))()},sendEditPositionRequest:function(n){var i=this;return r()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._59(i.position.departmentIdAttached,i.positionEdited.id,i.position.name,n,i.position.desc);case 2:(t=e.sent)&&200===t.code?(i.$Message.success("修改岗位成功！"),i.$router.push({name:"position"})):i.$Message.error("修改岗位失败！");case 4:case"end":return e.stop()}},e,i)}))()},cancelSaveDepartment:function(){this.ifDepartment?this.$router.push({name:"department"}):this.$router.push({name:"position"})},handleCheckAll:function(t){this.ifselected=!1,t.checkAll=!t.checkAll,t.indeterminate=!1,t.disabled||(t.checkAll?(t.permissionIds=[],t.functions.forEach(function(e){e.disabled||(e.selected=!0,t.permissionIds.push(e.id))})):(t.permissionIds=[],t.functions.forEach(function(e){e.disabled||(e.selected=!1)}))),this.renderCheckboxState(),this.ifselected=!0},handleCheckSingle:function(e,t){this.ifselected=!1;var n=e.permissionIds.indexOf(t.id);-1!==n?(t.selected=!1,e.permissionIds.splice(n,1)):(t.selected=!0,e.permissionIds.push(t.id)),e.permissionIds.length===e.checkboxAbledCount?e.checkAll=!0:e.checkAll=!1,0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?e.indeterminate=!0:e.indeterminate=!1,this.renderCheckboxState(),this.ifselected=!0}}}}.call(o,d(122))},1321:function(e,t,n){e.exports={render:function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{staticClass:"creat-department"},[s("div",{staticClass:"creat-department-content"},[i.ifDepartment?s("div",{staticClass:"creat-new-department"},[i.ifCreatDepartment?s("p",{staticClass:"creat-new-department-title PingFangSC-Medium-font"},[i._v("新建部门")]):s("p",{staticClass:"creat-new-department-title PingFangSC-Medium-font"},[i._v("修改部门")]),i._v(" "),i.ifCreatDepartment?s("p",{staticClass:"department-name"},[s("span",[i._v("部门名称：")]),s("Input",{attrs:{placeholder:"请输入部门名称"},model:{value:i.departmentName,callback:function(e){i.departmentName=e},expression:"departmentName"}})],1):s("p",{staticClass:"department-name"},[s("span",[i._v("部门名称：")]),s("Input",{attrs:{placeholder:"请输入部门名称"},model:{value:i.departmentEdited.name,callback:function(e){i.$set(i.departmentEdited,"name",e)},expression:"departmentEdited.name"}})],1)]):s("div",{staticClass:"creat-new-department"},[i.ifCreatPosition?s("p",{staticClass:"creat-new-department-title PingFangSC-Medium-font"},[i._v("新建自定义岗位")]):s("p",{staticClass:"creat-new-department-title PingFangSC-Medium-font"},[i._v("修改岗位")]),i._v(" "),s("Form",{ref:"position",attrs:{model:i.position,rules:i.ruleValidate,"label-width":100}},[s("FormItem",{attrs:{label:"选择部门：",prop:"department"}},[s("Select",{attrs:{placeholder:"请选择部门",disabled:!i.ifCreatPosition},model:{value:i.position.departmentIdAttached,callback:function(e){i.$set(i.position,"departmentIdAttached",e)},expression:"position.departmentIdAttached"}},i._l(i.allDepartments,function(t,e){return s("Option",{key:e,attrs:{value:t.id},nativeOn:{click:function(e){e.preventDefault(),i.selectDepartment(t)}}},[i._v("\n                            "+i._s(t.name)+"\n                        ")])}))],1),i._v(" "),s("FormItem",{attrs:{label:"岗位名称：",prop:"job"}},[s("Input",{attrs:{placeholder:"请输入岗位名称"},model:{value:i.position.name,callback:function(e){i.$set(i.position,"name",e)},expression:"position.name"}})],1),i._v(" "),s("FormItem",{attrs:{label:"岗位描述：",prop:"desc"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:10},placeholder:"请输入..."},model:{value:i.position.desc,callback:function(e){i.$set(i.position,"desc",e)},expression:"position.desc"}})],1)],1)],1),i._v(" "),s("div",{staticClass:"setting-permission"},[s("p",{staticClass:"setting-permission-title PingFangSC-Medium-font"},[i._v("权限设置")]),i._v(" "),s("div",{staticClass:"setting-permission-content"},[s("div",{staticClass:"store-permission permission"},[s("p",{staticClass:"title"},[i._v("店铺权限")]),i._v(" "),i._l(i.allInitPermissions,function(n,e){return"0"===n.type?s("div",{key:Math.random(),staticClass:"data-center"},[s("div",{directives:[{name:"show",rawName:"v-show",value:i.ifselected,expression:"ifselected"}]},[s("Checkbox",{attrs:{indeterminate:n.indeterminate,value:n.checkAll,disabled:n.disabled},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckAll(n)}}},[i._v("\n                                "+i._s(n.func_group_name)+"\n                            ")]),i._v(" "),s("p",{staticClass:"severed"}),i._v(" "),s("CheckboxGroup",{model:{value:n.permissionIds,callback:function(e){i.$set(n,"permissionIds",e)},expression:"permissionGroup.permissionIds"}},i._l(n.functions,function(t,e){return s("Checkbox",{key:Math.random(),attrs:{value:t.selected,label:t.id,disabled:t.disabled},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckSingle(n,t)}}},[i._v("\n                                    "+i._s(t.func_name)+"\n                                ")])}))],1)]):i._e()})],2),i._v(" "),s("div",{staticClass:"administrator-permission permission"},[s("p",{staticClass:"title"},[i._v("管理员权限")]),i._v(" "),i._l(i.allInitPermissions,function(n,e){return"1"===n.type?s("div",{key:Math.random(),staticClass:"data-center"},[s("div",{directives:[{name:"show",rawName:"v-show",value:i.ifselected,expression:"ifselected"}]},[s("Checkbox",{attrs:{indeterminate:n.indeterminate,value:n.checkAll,disabled:n.disabled},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckAll(n)}}},[i._v("\n                                "+i._s(n.func_group_name)+"\n                            ")]),i._v(" "),s("p",{staticClass:"severed"}),i._v(" "),s("CheckboxGroup",{model:{value:n.permissionIds,callback:function(e){i.$set(n,"permissionIds",e)},expression:"permissionGroup.permissionIds"}},i._l(n.functions,function(t,e){return s("Checkbox",{key:Math.random(),attrs:{value:t.selected,label:t.id,disabled:t.disabled},nativeOn:{click:function(e){e.preventDefault(),i.handleCheckSingle(n,t)}}},[i._v("\n                                    "+i._s(t.func_name)+"\n                                ")])}))],1)]):i._e()})],2)])])]),i._v(" "),s("p",{staticClass:"operation-button"},[s("Button",{attrs:{type:"primary"},on:{click:i.save}},[i._v("保存")]),i._v(" "),s("Button",{attrs:{type:"ghost"},on:{click:i.cancelSaveDepartment}},[i._v("取消")])],1)])},staticRenderFns:[]},e.exports.render._withStripped=!0},1408:function(e,t,n){var i=!1;var s=n(304)(n(1320),n(1321),function(e){i||n(1318)},"data-v-401dd738",null);s.options.__file="/Users/zhouqichao/Desktop/sxkj/shangu_online/src/components/views/salesclerkManage/children/creatDepartment.vue",s.esModule&&Object.keys(s.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] creatDepartment.vue: functional components are not supported with templates, they should use render functions."),e.exports=s.exports},829:function(e,t,n){"use strict";(function(r){t.a={methods:{getCheckboxAbledCounts:function(){this.allInitPermissions.forEach(function(t){t.functions.forEach(function(e){e.disabled||(t.checkboxAbledCount+=1)})})},formatAllInitPermissions:function(){this.allInitPermissions.forEach(function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,e.functions.forEach(function(e){e.selected=!1,e.disabled=!1})})},getAllStoresFromAreaSelected:function(t){this.allStoresFromAreaSelected=this.allInitStores.find(function(e){return e.title===t[0].title})},updateStoresSelectedCheckboxState:function(){var t=this;this.allStoresFromAreaSelected.storeGroupIds=[],this.allStoresIdListSelected.length?this.allStoresFromAreaSelected.stores.forEach(function(e){t.allStoresIdListSelected.includes(e.store_id)?(e.selected=!0,t.allStoresFromAreaSelected.storeGroupIds.push(e.store_id),t.allStoresFromAreaSelected.stores.every(function(e){return t.allStoresIdListSelected.includes(e.store_id)})&&t.allStoresFromAreaSelected.stores.length===t.allStoresFromAreaSelected.storeGroupIds.length?(t.allStoresFromAreaSelected.checkAll=!0,t.allStoresFromAreaSelected.indeterminate=!1):(t.allStoresFromAreaSelected.checkAll=!1,t.allStoresFromAreaSelected.indeterminate=!0)):(e.selected=!1,t.allStoresFromAreaSelected.checkAll=!1)}):(this.allStoresFromAreaSelected.checkAll=!1,this.allStoresFromAreaSelected.indeterminate=!1)},next:function(){var i=this;this.allStoresSelected.length?(this.openAddStoresModal=!1,this.openAddStorePermissionsModal=!0,this.employeeEdited.storesOfPermissionsAdded=[],this.allStoresSelected.forEach(function(t){var e=[];if(i.employeeEdited.storesManaged.length){var n=r.find(i.employeeEdited.storesManaged,function(e){return e.store_id===t.store_id});e=void 0!==n?n.permissionsSelected:i.employeeEdited.store_permissions}i.employeeEdited.storesOfPermissionsAdded.push({store_name:t.sotre_name,store_id:t.store_id,store_permissions:i.employeeEdited.store_permissions,permissionsSelected:r.cloneDeep(e)})}),this.selectStore(this.employeeEdited.storesOfPermissionsAdded[0].store_id)):this.$Notice.warning({title:"添加店铺",desc:"请先添加店铺"})},selectStore:function(t){this.ifselected=!1,this.storeIdSelected=t;var e=this.employeeEdited.storesOfPermissionsAdded.find(function(e){return e.store_id===t});this.resetAllInitPermissions(),this.allInitPermissions.forEach(function(e){e.disabled=!0,e.functions.forEach(function(e){e.disabled=!0})}),this.extendPermissionsOfPositionSelected(e),this.getCheckboxAbledCounts(),this.renderCheckboxState(),this.ifselected=!0},resetAllInitPermissions:function(){r.each(this.allInitPermissions,function(e){e.checkAll=!1,e.disabled=!1,e.indeterminate=!1,e.permissionIds=[],e.checkboxAbledCount=0,r.each(e.functions,function(e){e.selected=!1,e.disabled=!1})})},extendPermissionsOfPositionSelected:function(e){r.each(this.allInitPermissions,function(n){r.each(n.functions,function(t){r.each(e.store_permissions,function(e){t.id===e&&(t.disabled=!1)}),r.each(e.permissionsSelected,function(e){t.id===e&&(t.selected=!0,n.permissionIds.push(t.id))})})})},renderCheckboxState:function(){this.allInitPermissions.forEach(function(e){0!==e.checkboxAbledCount?e.permissionIds.length===e.checkboxAbledCount?(e.indeterminate=!1,e.disabled=!1,e.checkAll=!0):0<e.permissionIds.length&&e.permissionIds.length<e.checkboxAbledCount?(e.indeterminate=!0,e.disabled=!1):(e.disabled=!1,e.indeterminate=!1):(e.disabled=!0,e.checkAll=!1)})},extendPermissionsOfDepartmentSelected:function(i){var s=this;this.allInitPermissions.forEach(function(n){n.functions.forEach(function(e){if(i.totalPermissions.length){var t=[];r.isEmpty(s.positionEdited)?(t=i.totalPermissions).includes(e.id)&&(e.disabled=!1,e.selected=!0,n.permissionIds.push(e.id)):(t=r.intersection(i.totalPermissions,s.positionEdited.permissions),i.totalPermissions.includes(e.id)&&(e.disabled=!1),t.includes(e.id)&&(e.selected=!0,n.permissionIds.push(e.id)))}})})}}}}).call(t,n(122))}});